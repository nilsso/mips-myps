feedbackSrc = d0
targetSrc = d1
clearSrc = d2
kPSrc = d3
kISrc = d4
kDSrc = d5

fix kP = kPSrc.Setting # kP
fix kI = kISrc.Setting # kI
fix kD = kDSrc.Setting # kD

def dt = 0.5 # dT
fix target = targetSrc.Setting # target
fix feedback, I, lastError

while feedback  < target:
    yield()
    feedback  = feedbackSrc.Setting
    error = target - feedback
    P = kP * error # P = kP * error
    I += error * dt # I += error * dt
    D = (error - lastError) / dt # D = (error - lastError) / dt
    output = P + (kI * I) + (kD * D) # output = P+(kI*I)+(kd*D)
    db.Setting = output